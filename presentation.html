<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title></title>
<meta name="author" content="(Shukry Zablah)"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/css/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/css/theme/beige.css" id="theme"/>


<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/npm/reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<section id="slide-org09bba7a">
<h2 id="org09bba7a">Parallelization of the Cube Method for Balanced Sampling</h2>
<p>
Shukry Zablah
</p>

<p>
Advisor: Matteo Riondato
</p>

<p>
March 2, 2020
</p>
</section>
</section>
<section>
<section id="slide-org9d3bd9b">
<h2 id="org9d3bd9b">Preliminaries</h2>
<div class="outline-text-2" id="text-org9d3bd9b">
</div>
</section>
<section id="slide-orge581a98">
<h3 id="orge581a98">Motivation</h3>
<p>
For a population \(U\): \(\left\{u_{1}, \dots, u_{k}, \dots, u_{N}\right\}\)
</p>
<p class="fragment roll-in">
We want to study an unknown variable \(y\) taking a value \(y_k\) for \(k \in U\).
</p>
<p class="fragment roll-in">
In particular: \(T=f\left(y_{1} \cdots y_{k} \cdots y_{N}\right)\)
</p>
<aside class="notes">
<p>
Common functions: 
</p>
<ul>
<li>Total: \(Y=\sum_{k \in U} y_{k}\)</li>
<li>Population Size: \(N=\sum_{k \in U} 1\)</li>
<li>Mean: \(\bar{Y}=\frac{1}{N} \sum_{k \in U} y_{k}\)</li>
<li>Variance: V<sub>y</sub><sup>2</sup>=\frac{1}{N-1} &sum;<sub>k &isin; U</sub>\left(y<sub>k</sub>-\bar{Y}\right)<sup>2</sup>=\frac{1}{2 N(N-1)} &sum;<sub>k &isin; U</sub> &sum;<sub>&ell; &isin; U</sub>\left(y<sub>k</sub>-y<sub>&ell;</sub>\right)<sup>2</sup></li>

</ul>

</aside>
</section>
<section id="slide-org74d7cc7">
<h3 id="org74d7cc7">Auxiliary Variables</h3>
<p>
We also have \(p\) <i>known</i> auxiliary variables. 
\(\mathbf{x}_{k}=\left(\begin{array}{lllll}x_{k 1} & \cdots & x_{k j} & \cdots & x_{k p}\end{array}\right)^{\prime}\)
</p>
</section>
<section id="slide-org5f06081">
<h3 id="org5f06081">Sample w/o Replacement</h3>
<p>
\(\mathbf{s}=\left(\begin{array}{lllll}s_{1} & \cdots & s_{k} & \cdots & s_{N}\end{array}\right)^{\prime}\)
</p>
<p class="fragment roll-in">
\[s_{k}=\left\{\begin{array}{ll}1 & \text { if unit } k \text { is in the sample } \\ 0 & \text { if unit } k \text { is not in the sample }\end{array}\right.\]
</p>
<p class="fragment roll-in">
A support \(\mathcal{S}\) is a set of possible samples.
</p>
</section>
<section id="slide-orgb0f2cac">
<h3 id="orgb0f2cac">Sampling Design</h3>
<p>
A sampling design is a multivariate probability distribution on \(\mathcal{S}\)
</p>

<p>
\(\sum_{\mathbf{s} \in \mathcal{S}} p(\mathbf{s})=1\)
</p>
</section>
<section id="slide-org381443d">
<h3 id="org381443d">Inclusion Probabilities \(\mathbf{\pi}\)</h3>
<p>
\(\pi_{k}=\operatorname{Pr}\left(S_{k}>0\right)=\mathrm{E}\left[S_{k}\right]\)
</p>
</section>
</section>
<section>
<section id="slide-org55b0f7e">
<h2 id="org55b0f7e">Balanced Sampling</h2>
<p>
\(\mathcal{S}=\left\{\mathbf{s} \in \{0,1\}^{N} | \sum_{k \in U} \frac{x_{k j}}{\pi_{k}}=\sum_{k \in U} x_{k j}\right\}\),
</p>

<p>
for \(j = 0, 1, \dots, p\)
</p>
</section>
<section id="slide-org8c27ff8">
<h3 id="org8c27ff8">Geometric Representation (N = 3, p = 1)</h3>
<div class="column">
<p>
If our only auxiliary variable restricts us to \(n(\mathbf{s}) = 2\):
</p>
</div>
<div class="column" style="display:block;margin:auto; width:50%">

<div class="figure">
<p><img src="images/cube_fixedsamplesize.png" alt="cube_fixedsamplesize.png">
</p>
</div>
</div>
</section>
</section>
<section>
<section id="slide-org3cf3d55">
<h2 id="org3cf3d55">The Cube Method</h2>
<p>
Deville, Tille 2004
</p>

<p>
<code>sample = cube(X,</code> \(\pi\) <code>)</code>
</p>
</section>
<section id="slide-org7a27aaf">
<h3 id="org7a27aaf">Intuition</h3>
<p>
A random walk from \(\mathbf{\pi}\) to an \(\mathbf{s} \in \left(\{0,1\}^{N} \cap \mathcal{S}\right)\).
</p>
<div class="column" style="display:block;margin:auto; width:50%">

<div class="figure">
<p><img src="images/cube_randomwalk.png" alt="cube_randomwalk.png">
</p>
</div>
</div>
</section>
<section id="slide-org2f2e1ee">
<h3 id="org2f2e1ee">Fixed Sample Size (N = 4, p = 1)</h3>
<p>
If our only auxiliary variable restricts us to \(n(\mathbf{s}) = 2\):
</p>
<div class="column" style="font-size: 70%">
<p>
\[\pi=\left(\begin{array}{c}0.5 \\ 0.5 \\ 0.5 \\ 0.5\end{array}\right) \rightarrow\left(\begin{array}{c}0.6666 \\ 0.6666 \\ 0.6666 \\ 0\end{array}\right) \rightarrow\left(\begin{array}{c}1 \\ 0.5 \\ 0.5 \\ 0\end{array}\right) \rightarrow\left(\begin{array}{l}1 \\ 0 \\ 1 \\ 0\end{array}\right)=S\]
</p>
</div>
</section>
<section id="slide-orgdd09850">
<h3 id="orgdd09850">Stratification (N = 9, p = 3)</h3>
<p>
We can encode any balancing restriction, e.g. 2 strata and 1 other auxiliary variable:
</p>
<div class="column" style="font-size: 60%">
<p>
\(\pi=\left(\begin{array}{l}1 / 9 \\ 2 / 9 \\ 3 / 9 \\ 4 / 9 \\ 5 / 9 \\ 6 / 9 \\ 7 / 9 \\ 8 / 9\end{array}\right), \mathbf{X}=\left(\begin{array}{l}0 & 1 & 1 \\ 0 & 1 & 2 \\ 1 & 0 &  3 \\ 1 & 0 & 4 \\ 1 & 0 & 5 \\ 1 & 0 & 6 \\ 0 & 1 & 7 \\ 0 & 1 & 8\end{array}\right)\)
</p>
</div>
</section>
</section>
<section>
<section id="slide-org7ba8fcd">
<h2 id="org7ba8fcd">Related Works</h2>
<p class="fragment roll-in">
Chauvet 2006: A Fast Algorithm for Balanced Sampling
</p>
<p class="fragment roll-in">
Chauvet 2009: Stratified Balanced Sampling
</p>
<p class="fragment roll-in">
Hasler, Tille 2013: Fast Balanced Sampling for Highly Stratified Populations
</p>
</section>
</section>
<section>
<section id="slide-org32d0d5e">
<h2 id="org32d0d5e">Parallelization</h2>
<div class="outline-text-2" id="text-org32d0d5e">
</div>
</section>
<section id="slide-orgeb73222">
<h3 id="orgeb73222">First Method</h3>
<ul>
<li>Partition the population into "strata".</li>
<li>Apply the cube method to the partitions. (parallel)</li>
<li>Reconcile the fact that the partition took place. (Chauvet 2009)</li>

</ul>
</section>
<section id="slide-org04c5624">
<h3 id="org04c5624">Second Method</h3>
<ul>
<li>Partition the population into "strata"</li>
<li>Work on increasingly larger and overlapping unions of strata.</li>
<li>Reconcile the fact that the partition took place. (Hasler, Tille 2013)</li>

</ul>
</section>
<section id="slide-org20292a3">
<h3 id="org20292a3">Progress</h3>
<ul>
<li>First implementation (first readable one too) of the cube method in Python.</li>
<li>Successfully implemented the first parallel implementation.</li>
<li>Still have to do second method.</li>
<li>Still have to run experiments to compare implementations.</li>

</ul>
</section>
</section>
<section>
<section id="slide-org900e05c">
<h2 id="org900e05c">Questions?</h2>
<div class="outline-text-2" id="text-org900e05c">
</div>
</section>
<section id="slide-orgb1434f9">
<h3 id="orgb1434f9">Why is the sum of \(\mathbf{\pi} = n(\mathbf{s})\)?</h3>
<p>
\(\boldsymbol{\mu}=\mathrm{E}(\mathbf{S})=\sum_{\mathbf{s} \in \mathcal{Q}} p(\mathbf{s}) \mathbf{s}\)
</p>
<p class="fragment roll-in">
\(\sum_{k \in U} \mu_{k}=\mathrm{E}[n(\mathbf{S})]\)
</p>
<p class="fragment roll-in">
And in our setting: \(\pi=\mu\)
</p>
</section>
<section id="slide-org9d42879">
<h3 id="org9d42879">Horvitz Thompson Estimator</h3>
<p>
The HT estimator is an unbiased estimator that works for sampling with
or without replacement and with unequal inclusion probabilities.
</p>

<p>
\(\widehat{Y}_{H T}=\sum_{k \in U} \frac{S_{k} y_{k}}{\pi_{k}}\)
</p>

<p>
If \(\pi_k = n / N\) for every \(k\) (SRS), then the estimator becomes \(N\bar{y}\)
</p>
</section>
<section id="slide-orgedeb601">
<h3 id="orgedeb601">How do I choose \(\mathbf{\pi}\)</h3>
<p>
Inclusion probabilities are chosen either by necessity or to lower the
variance of our estimator of Y (e.g. proportional to some auxiliary variable). 
</p>

<p>
Nedyalkova, Tille 2009
</p>
</section>
<section id="slide-org4ac4674">
<h3 id="org4ac4674">The Rounding Problem</h3>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]
});
</script>
</body>
</html>
